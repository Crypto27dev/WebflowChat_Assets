(this.webpackJsonpchatapp=this.webpackJsonpchatapp||[]).push([[0],{154:function(e,t,c){},174:function(e,t,c){},175:function(e,t,c){},176:function(e,t,c){},177:function(e,t,c){},178:function(e,t,c){},179:function(e,t,c){},180:function(e,t,c){},181:function(e,t,c){},190:function(e,t,c){"use strict";c.r(t);var n=c(0),a=c(55),s=c.n(a),r=c(49),i=(c(154),c(1)),o=c(4),l=c(13),u=(c(92),c(23)),j=c.n(u),d=function(e,t){switch(t.type){case"LOGIN_START":return{user:t.payload,isLoading:!0,error:!1};case"LOGIN_SUCCESS":return{user:t.payload,isLoading:!1,error:!1};case"LOGIN_FAILURE":return{user:null,isLoading:!1,error:t.payload};default:return e}},b=c(3),p={user:null,isFetching:!1,error:!1},O=Object(n.createContext)(p),h=function(e){var t=e.children,c=Object(n.useReducer)(d,p),a=Object(l.a)(c,2),s=a[0],r=a[1];return Object(n.useEffect)((function(){localStorage.setItem("user",JSON.stringify(s.user))}),[s.user]),Object(b.jsx)(O.Provider,{value:{user:s.user,isFetching:s.isFetching,error:s.error,dispatch:r},children:t})};var m=function(){var e=Object(r.useMemberstack)().getCurrentMember,t=Object(r.useMemberstackModal)(),c=t.openModal,a=t.hideModal,s=Object(n.useState)(null),u=Object(l.a)(s,2),d=(u[0],u[1]),p=Object(n.useContext)(O).dispatch,h="http://95.217.102.97:5000/";Object(n.useEffect)((function(){e().then((function(e){var t=e.data;return d(t)}))}),[]);var m=function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var c;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c={email:t.member.auth.email},e.next=4,j.a.post(h+"api/auth/signup",c);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,c){var n;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c({type:"LOGIN_START"}),e.prev=1,e.next=4,j.a.post(h+"api/auth/signin",t);case 4:n=e.sent,c({type:"LOGIN_SUCCESS",payload:n.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),c({type:"LOGIN_FAILURE",payload:e.t0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,c){return e.apply(this,arguments)}}();return Object(b.jsxs)("div",{className:"signin-container",children:[Object(b.jsxs)("div",{className:"signin-content",children:[Object(b.jsx)("h1",{children:"Welcome"}),Object(b.jsxs)("div",{className:"btn-group",children:[Object(b.jsx)("button",{className:"btn btn-login",onClick:function(){c({type:"LOGIN"}).then((function(e){var t=e.data,c=e.type;if(console.log("data",t),console.log("type: ",c),"LOGIN"===c){var n=t.member.auth;f({email:n.email},p),a()}}))},children:"Log In"}),Object(b.jsx)("button",{className:"btn btn-signup",onClick:function(){c({type:"SIGNUP",planId:"pln_test-memberstack-c7iw0rew"}).then((function(e){var t=e.data,c=e.type;if(console.log("data",t),console.log("type: ",c),"SIGNUP"===c){m(t);var n=t.member.auth;f({email:n.email},p),a()}else if("LOGIN"===c){var s=t.member.auth;f({email:s.email},p),a()}}))},children:"Sign Up"})]})]}),Object(b.jsxs)("footer",{children:[Object(b.jsx)("span",{children:"@Copyright2023"}),Object(b.jsx)("span",{children:"Vladimir"})]})]})};var f=c(8),v=(c(174),c(175),c(176),c(177),c(116));var x=function(e){var t=e.message,c=e.own;return Object(b.jsx)("div",{children:Object(b.jsxs)("p",{className:c?"message-sent":"message-received",children:[Object(b.jsx)("span",{children:t.text}),Object(b.jsx)("span",{className:"message-time",children:Object(v.a)(t.createdAt)})]})})};c(178);var g=function(e){var t=e.addchattoggler,c=e.addchattoggle,a=Object(n.useState)(),s=Object(l.a)(a,2),r=s[0],u=s[1],d=Object(n.useContext)(O).user,p="http://95.217.102.97:5000/",h=function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var c,n;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,j.a.get("".concat(p,"api/users/?username=").concat(r));case 4:return c=e.sent,u(""),n={senderId:d._id,receiverId:c.data._id},e.next=9,j.a.post(p+"api/chatrooms",n);case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(1);case 13:window.location.reload();case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(b.jsx)("div",{className:"add-amigo-background",children:Object(b.jsxs)("div",{className:c?"add-amigo-open":"add-amigo-close",children:[Object(b.jsx)("div",{className:"close-div",children:Object(b.jsx)("span",{onClick:t,children:Object(b.jsx)("p",{className:"close-symbol",children:"x"})})}),Object(b.jsxs)("form",{children:[Object(b.jsx)("img",{className:"add-amigo-img",src:"assets/addamigo.png",alt:""}),Object(b.jsx)("input",{type:"text",placeholder:"Enter Username of Amigo",value:r,onChange:function(e){u(e.target.value)},required:!0}),Object(b.jsx)("button",{onClick:h,children:"ADD AMIGO"})]})]})})};c(179);var N=function(e){var t=e.toggler,c=e.togglestate,a=Object(n.useContext)(O).user,s=Object(n.useState)(a.username),r=Object(l.a)(s,2),u=r[0],d=r[1],p=Object(n.useState)(""),h=Object(l.a)(p,2),m=h[0],f=h[1],v="http://95.217.102.97:5000/",x=function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var c,n,s,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),c={headers:{"Content-Type":"multipart/form-data"}},(n=new FormData).append("username",u),""!==m&&n.append("photo",m),e.prev=5,e.next=8,j.a.put(v+"api/users/"+(null===a||void 0===a?void 0:a._id),n,c);case 8:return e.next=10,j.a.get(v+"api/users/"+(null===a||void 0===a?void 0:a._id));case 10:s=e.sent,r=JSON.stringify(s.data),localStorage.setItem("user",r),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),console.log(e.t0);case 18:window.location.reload();case 19:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(b.jsx)("div",{className:"profile",children:Object(b.jsxs)("div",{className:c?"profile-card-open":"profile-card-close",children:[Object(b.jsx)("div",{className:"close-div",children:Object(b.jsx)("span",{onClick:t,children:Object(b.jsx)("p",{className:"close-symbol",children:"x"})})}),Object(b.jsx)("img",{className:"profile-image",src:null!==a&&void 0!==a&&a.photo?v+"photo/"+(null===a||void 0===a?void 0:a.photo):"assets/noavatar.jpg",alt:""}),Object(b.jsxs)("form",{children:[Object(b.jsx)("label",{htmlFor:"username",children:"Username"}),Object(b.jsx)("input",{type:"text",className:"username-input",value:u,onChange:function(e){d(e.target.value)},required:!0}),Object(b.jsx)("input",{className:"update-profilepic",type:"file",accept:".png, .jpg, .jpeg, .gif",name:"photo",onChange:function(e){f(e.target.files[0])}}),Object(b.jsx)("button",{onClick:x,children:"UPDATE"})]})]})})},k=(c(180),c(68));var y=function(e){var t=e.chatroomtile,c=e.currentUser,a=Object(n.useState)(null),s=Object(l.a)(a,2),r=s[0],u=s[1],d=Object(n.useState)(!1),p=Object(l.a)(d,2),O=p[0],h=p[1],m=Object(n.useRef)(),f="http://95.217.102.97:5000/";return Object(n.useEffect)((function(){m.current=Object(k.a)(f)}),[f]),Object(n.useEffect)((function(){var e=t.members.find((function(e){return e!==c._id}));m.current.on("getUsers",(function(t){h(t.find((function(t){return t.userId===e})))}));var n=function(){var t=Object(o.a)(Object(i.a)().mark((function t(){var c;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,j.a.get(f+"api/users/"+e);case 3:c=t.sent,u(c.data),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();n()}),[c,t,O,f]),Object(b.jsxs)("div",{className:"sidebarchat",children:[Object(b.jsx)("img",{className:"amigo-profilepic",src:null!==r&&void 0!==r&&r.photo?f+"photo/"+(null===r||void 0===r?void 0:r.photo):"assets/noavatar.jpg",alt:""}),Object(b.jsx)("div",{className:O?"online":"offile"}),Object(b.jsx)("p",{className:"sidebarchat-info-name",children:null!=r?r.username:""})]})};c(181);var S=function(){return Object(b.jsx)("div",{children:Object(b.jsx)("div",{className:"EmptyChatroom",children:Object(b.jsx)("img",{className:"emptychatroom-img",src:"assets/home.png",alt:""})})})},w=(c(182),c(115)),C=c(114),I=c.n(C),_=c(107),E=c.n(_),L=c(109),U=c.n(L),G=c(111),A=c.n(G),M=c(205),D=c(110),F=c.n(D),R=c(108),T=c.n(R),P=c(113),J=c.n(P),q=c(112),z=c.n(q);var V=function(){var e=Object(n.useState)([]),t=Object(l.a)(e,2),c=t[0],a=t[1],s=Object(n.useState)(null),r=Object(l.a)(s,2),u=r[0],d=r[1],p=Object(n.useState)([]),h=Object(l.a)(p,2),m=h[0],v=h[1],C=Object(n.useState)(""),_=Object(l.a)(C,2),L=_[0],G=_[1],D=Object(n.useState)(null),R=Object(l.a)(D,2),P=R[0],q=R[1],V=Object(n.useState)(),B=Object(l.a)(V,2),K=B[0],W=B[1],H=Object(n.useState)(!1),Q=Object(l.a)(H,2),X=Q[0],Y=Q[1],Z=Object(n.useContext)(O).user,$=Object(n.useRef)(),ee=Object(n.useRef)(),te="http://95.217.102.97:5000/";Object(n.useEffect)((function(){ee.current=Object(k.a)(te),ee.current.on("getMessage",(function(e){q({sender:e.senderId,text:e.text,createdAt:Date.now()})}))}),[te]),Object(n.useEffect)((function(){P&&(null===u||void 0===u?void 0:u.members.includes(P.sender))&&v((function(e){return[].concat(Object(f.a)(e),[P])}))}),[P,u]),Object(n.useEffect)((function(){ee.current.emit("addUser",null===Z||void 0===Z?void 0:Z._id)}),[Z,c,u,ee]),Object(n.useEffect)((function(){var e=function(){var e=Object(o.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.a.get(te+"api/chatrooms/"+Z._id);case 3:t=e.sent,a(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[null===Z||void 0===Z?void 0:Z._id,te]),Object(n.useEffect)((function(){var e=null===u||void 0===u?void 0:u.members.find((function(e){return e!==Z._id})),t=function(){var t=Object(o.a)(Object(i.a)().mark((function t(){var c;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,j.a.get(te+"api/users/"+e);case 3:c=t.sent,W(c.data),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();t()}),[Z,u,te]),Object(n.useEffect)((function(){var e=function(){var e=Object(o.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.a.get(te+"api/messages/"+(null===u||void 0===u?void 0:u._id));case 3:t=e.sent,v(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[u,te]),Object(n.useEffect)((function(){var e;null===(e=$.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[m]);var ce=Object(n.useState)(!1),ne=Object(l.a)(ce,2),ae=ne[0],se=ne[1],re=function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var c,n,a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),c={chatroomId:u._id,senderId:Z._id,text:L},n=u.members.find((function(e){return e!==Z._id})),ee.current.emit("sendMessage",{senderId:Z._id,receiverId:n,text:L}),e.prev=4,e.next=7,j.a.post(te+"api/messages/",c);case 7:a=e.sent,v([].concat(Object(f.a)(m),[a.data])),G(""),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),console.log(e.t0);case 15:se(!1);case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}(),ie=Object(n.useState)(!1),oe=Object(l.a)(ie,2),le=oe[0],ue=oe[1],je=function(){ue(!1===le),console.log(le)},de=Object(n.useState)(!1),be=Object(l.a)(de,2),pe=be[0],Oe=be[1],he=function(){Oe(!1===pe)};return Object(b.jsxs)("div",{className:"home",children:[Object(b.jsx)(g,{addchattoggler:function(){je()},addchattoggle:le}),Object(b.jsx)(N,{toggler:function(){he()},togglestate:pe}),X?"":Object(b.jsx)("div",{className:"menu-open",onClick:function(){Y(!0)},children:Object(b.jsx)(M.a,{children:Object(b.jsx)(E.a,{style:{fontSize:35,color:"#316af3"}})})}),Object(b.jsx)("div",{className:"add-chatroom-icon",onClick:je,children:Object(b.jsx)(M.a,{children:Object(b.jsx)(T.a,{})})}),Object(b.jsxs)("div",{className:"home-components",children:[Object(b.jsxs)("div",{className:X?"sidebar active":"sidebar",children:[Object(b.jsxs)("div",{className:"sidebar-header",children:[Object(b.jsx)("div",{className:"menu-close",onClick:function(){Y(!1)},children:Object(b.jsx)(M.a,{children:Object(b.jsx)(U.a,{style:{fontSize:35,color:"white"}})})}),Object(b.jsx)(M.a,{onClick:function(){he()},children:Object(b.jsx)("img",{className:"user-profile-image",src:null!==Z&&void 0!==Z&&Z.photo?te+"photo/"+(null===Z||void 0===Z?void 0:Z.photo):"assets/noavatar.jpg",alt:""})}),Object(b.jsx)("div",{className:"logout-option",children:Object(b.jsx)(M.a,{onClick:function(){localStorage.removeItem("user"),window.location.reload()},children:Object(b.jsx)(F.a,{})})})]}),Object(b.jsx)("div",{className:"sidebar-search",children:Object(b.jsxs)("div",{className:"sidebar-search-container",children:[Object(b.jsx)(A.a,{className:"sidebar-searchicon"}),Object(b.jsx)("input",{type:"text",name:"chat-search",placeholder:"Search a Chat"})]})}),Object(b.jsx)("div",{className:"sidebar-chatoptions",children:c.map((function(e){return Object(b.jsx)("div",{onClick:function(){d(e),Y(!1)},children:Object(b.jsx)(y,{chatroomtile:e,currentUser:Z})},null===e||void 0===e?void 0:e._id)}))})]}),Object(b.jsx)("div",{className:"chatroom",children:u?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{className:"chatroom-header",children:Object(b.jsxs)("div",{className:"chatroom-chatinfo",children:[Object(b.jsx)("img",{className:"amigo-profilepic",src:null!==K&&void 0!==K&&K.photo?te+"photo/"+(null===K||void 0===K?void 0:K.photo):"assets/noavatar.jpg",alt:""}),Object(b.jsx)("div",{className:"chatroom-chatinfo-right",children:Object(b.jsx)("div",{className:"chatroom-chatinfo-name",children:Object(b.jsx)("p",{children:null===K||void 0===K?void 0:K.username})})})]})}),Object(b.jsx)("div",{className:"chatroom-messages-container",onClick:function(){se(!1)},children:m.map((function(e){return Object(b.jsx)("div",{ref:$,children:Object(b.jsx)(x,{message:e,own:(null===e||void 0===e?void 0:e.senderId)===Z._id})},null===e||void 0===e?void 0:e._id)}))}),Object(b.jsx)("div",{className:ae?"emoji-picker-open":"emoji-picker-close",children:Object(b.jsx)(w.a,{onSelect:function(e){var t=e.native;G(L+t)},emojiSize:25})}),Object(b.jsxs)("div",{className:"chatroom-footer",children:[Object(b.jsxs)("div",{className:"chatroom-footer-lefticons",children:[Object(b.jsx)(M.a,{onClick:function(){se(!ae)},children:Object(b.jsx)(z.a,{})}),Object(b.jsx)(M.a,{children:Object(b.jsx)(J.a,{})})]}),Object(b.jsxs)("form",{children:[Object(b.jsx)("input",{className:"message-input",type:"text",name:"message-input",placeholder:"Type a message",onChange:function(e){G(e.target.value)},value:L,required:!0}),Object(b.jsx)("button",{className:"input-button",onClick:L?re:null,children:" Send a Message "})]}),Object(b.jsx)("div",{className:"chatroom-footer-righticon",onClick:L?re:null,children:Object(b.jsx)(M.a,{children:Object(b.jsx)(I.a,{className:"send-icon"})})})]})]}):Object(b.jsx)(S,{})})]})]})},B=c(75),K=c(16);var W=function(){var e=Object(n.useContext)(O).user;return Object(b.jsx)(B.a,{children:Object(b.jsx)("div",{className:"App",children:Object(b.jsx)(K.c,{children:Object(b.jsx)(K.a,{exact:!0,path:"/",children:e?Object(b.jsx)(V,{}):Object(b.jsx)(m,{})})})})})};s.a.render(Object(b.jsx)(r.MemberstackProvider,{config:{publicKey:"pk_sb_0669edd901db4905608e"},children:Object(b.jsx)(h,{children:Object(b.jsx)(W,{})})}),document.getElementById("root"))},92:function(e,t,c){}},[[190,1,2]]]);